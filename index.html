<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barkod Taray覺c覺</title>
    <style>
        video {
            width: 100%;
            height: auto;
        }
        #barcode {
            font-size: 1.5em;
            margin-top: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>Barkod Taray覺c覺</h1>
    <video autoplay></video>
    <p id="barcode">Bekleniyor...</p>

    <script>
        (async function() {
            // Check if the Barcode Detection API is supported
            if (!('BarcodeDetector' in window)) {
                alert('Barcode Detection API not supported by this browser.');
                return;
            }

            // Create a BarcodeDetector instance
            const barcodeDetector = new BarcodeDetector({ formats: ['ean_13', 'ean_8', 'upc_a', 'upc_e'] });

            // Get a stream for the rear camera
            const videoElement = document.querySelector('video');
            videoElement.srcObject = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });

            // Let's scan barcodes forever
            while (true) {
                // Try to detect barcodes in the current video frame
                const barcodes = await barcodeDetector.detect(videoElement);

                // Continue loop if no barcode was found
                if (barcodes.length === 0) {
                    // Scan interval 50 ms like in other barcode scanner demos
                    // The higher the interval the longer the battery lasts
                    await new Promise(r => setTimeout(r, 50));
                    continue;
                }

                // We expect a single barcode
                // It's possible to compare X/Y coordinates to get the center-most one
                // One can also do "preferred symbology" logic here
                document.getElementById("barcode").innerText = barcodes[0].rawValue;

                // Notify user that a barcode has been found
                navigator.vibrate(200);

                // Give the user time to find another product to scan
                await new Promise(r => setTimeout(r, 1000));
            }
        })();
    </script>
</body>
</html>
